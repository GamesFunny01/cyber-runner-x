<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <!-- Viewport stabil (no-zoom, safe for notch) -->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1, user-scalable=no, interactive-widget=overlays-content"
    />
    <meta name="format-detection" content="telephone=no" />
    <meta name="theme-color" content="#0B0B12" />
    <title>Cyber Runner X</title>

    <style>
      /* Tinggi dikunci ke --app-vh (dibekukan) + 100svh sebagai fallback modern */
      html, body, #root { height: var(--app-vh, 100svh); min-height: var(--app-vh, 100svh); }
      * { -webkit-tap-highlight-color: transparent; }
      body { margin: 0; background: #0B0B12; overscroll-behavior-y: none; }
    </style>

    <script>
      // --- Bekukan tinggi viewport (hindari auto-zoom saat address bar hide/show) ---
      (function () {
        function freezeVH() {
          const vv = window.visualViewport;
          const h = vv ? vv.height : window.innerHeight;
          document.documentElement.style.setProperty('--app-vh', h + 'px');
        }
        // set sekali saat load
        freezeVH();
        // update hanya saat orientasi berubah (bukan saat user scroll)
        window.addEventListener('orientationchange', function () {
          setTimeout(freezeVH, 250);
        }, { passive: true });
        // juga saat kembali dari bground
        window.addEventListener('pageshow', function(){ setTimeout(freezeVH, 150); }, { passive: true });
      })();

      // --- Cegah pinch/double-tap zoom ---
      (function () {
        const prevent = e => { e.preventDefault(); };
        document.addEventListener('gesturestart', prevent, { passive: false });
        document.addEventListener('wheel', e => { if (e.ctrlKey) e.preventDefault(); }, { passive: false });
        let lastTouch = 0;
        document.addEventListener('touchend', e => {
          const now = Date.now();
          if (now - lastTouch < 300) e.preventDefault();
          lastTouch = now;
        }, { passive: false });
      })();

      // --- iOS: paksa auth jadi full-page redirect (bypass popup blocker/ITP) ---
      (function () {
        const ua = navigator.userAgent || '';
        const isIOS = /iP(hone|od|ad)/.test(ua);
        if (!isIOS) return;
        const originalOpen = window.open;
        window.open = function (url) {
          try {
            if (typeof url === 'string' && /(privy|auth|login|connect|wallet)/i.test(url)) {
              location.href = url; return null;
            }
          } catch (_) {}
          return originalOpen ? originalOpen.apply(window, arguments) : null;
        };
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
